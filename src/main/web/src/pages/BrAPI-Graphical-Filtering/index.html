<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" ng-app="mainApp">
<head>
	<meta charset="utf-8">
	<title>BrAPI Graphical Filtering</title>
	<link th:href="@{/controller/static/lib/bootstrap-3.3.7.min.css}" rel="stylesheet"/>
	<link th:href="@{/controller/pages/BrAPI-Graphical-Filtering/style.css}" rel="stylesheet"/>
	<link th:href="@{/controller/static/lib/jquery.dataTables-1.10.16.min.css}" rel="stylesheet"/>
	<link th:href="@{/controller/static/lib/select2/select2.css}" rel="stylesheet"/>
	<link th:href="@{/controller/static/lib/font-awesome-4.2.0/css/font-awesome.css}" rel="stylesheet"/>
	<style type="text/css">
		.my-popover-content {
			display: none;
		}
	</style>
</head>
<body ng-controller="MainController">
<div style="margin:1em" class="container-fluid">
	<div class="row">
		<div class="col-md-8 col-xs-8">
			<h2 style="margin-top: 0; margin-bottom: 20px">BrAPI Graphical Filtering</h2>
		</div>
	</div>
	<div class="row">
		<div class="col-md-8 col-xs-8">
			<div class="alert alert-danger alert-dismissible" ng-if="errorMessage">
				<a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
				<strong>Export Error!</strong> {{errorMessage}}
			</div>
			<form id="brapi-form" action="javascript:void(0);" class="form-horizontal">
				<div class="form-group">
					<label class="control-label col-sm-4">Study name</label>
					<div class="col-sm-8" id="trials">
					</div>
				</div>
				<div class="form-group">
					<label class="control-label col-sm-4">Locations</label>
					<div class="col-sm-8" id="locations">

					</div>
				</div>
				<div class="form-group">
					<label class="control-label col-sm-4">GIDs</label>
					<div class="col-sm-8">
						<input type="text" class="form-control" name="germplasmDbIds"/>
					</div>
				</div>
				<div class="form-group">
					<label class="control-label col-sm-4">Observation level</label>
					<div class="col-sm-8" id="observationLevels"></div>
				</div>
				<div class="form-group">
					<label class="control-label col-sm-4">Observation timestamp range start</label>
					<div class="col-sm-8">
						<input type="text" class="form-control" name="observationTimeStampRangeStart"/>
					</div>
				</div>
				<div class="form-group">
					<label class="control-label col-sm-4">Observation timestamp range end</label>
					<div class="col-sm-8">
						<input type="text" class="form-control" name="observationTimeStampRangeEnd"/>
					</div>
				</div>

				<div class="form-group">
					<label class="control-label col-sm-4">Group By Accession</label>
					<div class="col-sm-8">
						<input type="checkbox" name="group"/>
					</div>
				</div>
				<div class="form-group">
					<div class="col-sm-offset-4 col-sm-8">
						<input type="submit" action="#" id="load-brapi"
							   class="btn btn-primary" value="Load"/>
					</div>
				</div>
			</form>
		</div>
		<div class="row">
			<div class="col-md-8 col-xs-8 form-horizontal">
				<div class="form-group">
					<label class="control-label col-sm-4">R Reshape transformation</label>
					<div class="col-sm-7">
						<select class="form-control" ng-options="item as item.description for item in rCallObjects" ng-model="selectedRCallObject"></select>
					</div>
					<div class="col-sm-1">
						<i class="fa fa-question-circle fa-2x" aria-hidden="true" data-toggle="popover"
						   title="About Formula"></i>
						<div class="my-popover-content">
							By default, all trait columns in the table are considered measure variables.
							Measure variable columns are the ones that will be collapsed (combined) by the Melt R function.
							Measure variables are represented as <em>variable</em> in the formula.
							<br/><br/>
							You can use the following variables in the formula:<br/><br/>
							<em>instanceNumber</em> - Trial Instance<br/>
							<em>studyDbId</em> - Database ID of Study<br/>
							<em>studyName</em> - Name of Study<br/>
							<em>observationUnitName</em> - Name<br/>
							<em>observationUnitDbId</em> - Observation Unit Identifier<br/>
							<em>germplasmName</em> - Accession<br/>
							<em>entryNumber</em> - Entry Number<br/>
							<em>germplasmDbId</em> - GID<br/>
							<em>studyLocation</em> - Location Name of Study<br/>
						</div>
					</div>
				</div>
				<div class="form-group" ng-repeat="(key, value) in selectedRCallObject.parameters">
					<label class="control-label col-sm-4">{{key}}</label>
					<div class="col-sm-8">
						<input type="text" class="form-control" ng-model="selectedRCallObject.parameters[key]"/>
					</div>
				</div>
				<div class="form-group">
					<div class="col-sm-4"></div>
					<div class="col-sm-2">
						<button action="#" id="export"
								class="btn btn-primary" value="Export" ng-click="onExportClick()">
							Export
						</button>
					</div>
					<div class="col-sm-1">
						<div loading-status-message><img th:src="@{/controller/static/images/loading-blue-on-white-lg.gif}" alt="loading" height="32" width="32"/></div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="row">
		<div class="col-md-12 col-xs-12">
			<div id="filter_div" style="margin:1em"></div>
			<table id="filtered_results" width="100%"></table>
		</div>
	</div>
	<hr/>
	<div class="row">
		<div class="col-md-12 col-xs-12">
			<a href="https://github.com/solgenomics/BrAPI-Graphical-Filtering" target="_blank">
				<img style="width: 40px;"
					 th:src="@{/controller/static/images/nextgen_cassava_icon.png}"/></a>
		</div>
	</div>
</div>
</body>
<script th:src="@{/controller/static/js/lib/jquery-3.2.1.min.js}"></script>
<script th:src="@{/controller/static/js/lib/d3-4.12.0.min.js}"></script>
<script th:src="@{/controller/static/js/lib/bootstrap-3.3.7.min.js}"></script>
<script th:src="@{/controller/static/js/lib/jquery.dataTables-1.10.16.min.js}" charset="utf-8"></script>
<script th:src="@{/controller/static/js/lib/get-url-parameter.js}" charset="utf-8"></script>
<script th:src="@{/controller/static/js/lib/select2.min.js}" charset="utf-8"></script>
<script th:src="@{/controller/static/js/lib/angular.min.js}" charset="utf-8"></script>
<script th:src="@{/controller/pages/BrAPI-Graphical-Filtering/GraphicalFilter.js}"></script>
<script th:src="@{/controller/pages/BrAPI-Graphical-Filtering/main.js}"></script>
</html>
